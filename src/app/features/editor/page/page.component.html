<div
  class="page__surface"
  [class.page__surface--active]="isActive"
  [style.width.px]="widthPx"
  [style.height.px]="heightPx"
  [attr.id]="surfaceId"
>
  <!-- Fixed Logo at Top Right -->
  <div class="page__logo-placeholder">
    <img
      [src]="displayLogoUrl"
      alt="Logo"
      class="page__logo-image"
    />
  </div>

  <!-- Widgets Container - New ID-based approach -->
  <!-- Each widget selects its own data using widgetId -->
  <ng-container *ngIf="!useLegacyMode">
    <app-widget-container
      *ngFor="let widgetId of widgetIds; trackBy: trackByWidgetId"
      [widgetId]="widgetId"
      [pageSize]="pageSize"
      [pageId]="pageId || page?.id || ''"
      [subsectionId]="subsectionId"
      [pageWidth]="widthPx"
      [pageHeight]="heightPx"
    ></app-widget-container>
  </ng-container>
  
  <!-- Legacy mode: Full widget objects (backward compatibility) -->
  <ng-container *ngIf="useLegacyMode">
    <app-widget-container
      *ngFor="let widget of legacyWidgets; trackBy: trackByWidgetId"
      [widgetId]="widget.id"
      [widget]="widget"
      [pageSize]="pageSize"
      [pageId]="page?.id || ''"
      [subsectionId]="subsectionId"
      [pageWidth]="widthPx"
      [pageHeight]="heightPx"
    ></app-widget-container>
  </ng-container>

  <!-- Fixed Footer Elements at Bottom -->
  <div class="page__footer" *ngIf="footerLeftText || footerCenterText || showPageNumber">
    <!-- Bottom Left Text - Blue -->
    <div class="page__footer-left" *ngIf="footerLeftText">
      {{ footerLeftText }}
    </div>
    <div class="page__footer-left" *ngIf="!footerLeftText"></div>
    
    <!-- Bottom Middle Text -->
    <div class="page__footer-center" *ngIf="footerCenterText || footerSubText">
      <div class="page__footer-center-line" *ngIf="footerCenterText">
        {{ footerCenterText }}
      </div>
      <div class="page__footer-center-line" *ngIf="footerSubText">
        {{ footerSubText }}
      </div>
    </div>
    <div class="page__footer-center" *ngIf="!footerCenterText && !footerSubText"></div>
    
    <!-- Bottom Right - Page Number -->
    <div class="page__footer-right" *ngIf="showPageNumber">
      {{ pageNumber }}
    </div>
    <div class="page__footer-right" *ngIf="!showPageNumber"></div>
  </div>
</div>
