<div class="table-toolbar">
  <div class="table-toolbar__group">
    <button
      type="button"
      class="table-toolbar__button table-toolbar__button--wide"
      (mousedown)="openSplitDialog($event)"
      title="Split cell (Rows/Columns)"
    >
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="3" y="3" width="18" height="18" rx="1"></rect>
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="12" y1="3" x2="12" y2="21"></line>
      </svg>
      <span class="table-toolbar__button-label">Split</span>
    </button>

    <button
      type="button"
      class="table-toolbar__button table-toolbar__button--wide"
      (mousedown)="onMergeClick($event)"
      title="Merge selected cells (rectangle)"
    >
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="3" y="6" width="18" height="12" rx="1"></rect>
        <path d="M7 12h10"></path>
        <path d="M9 10l-2 2 2 2"></path>
        <path d="M15 10l2 2-2 2"></path>
      </svg>
      <span class="table-toolbar__button-label">Merge</span>
    </button>

    <button
      type="button"
      class="table-toolbar__button table-toolbar__button--wide"
      (mousedown)="onUnmergeClick($event)"
      title="Unmerge"
    >
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="3" y="6" width="18" height="12" rx="1"></rect>
        <path d="M7 12h10"></path>
        <path d="M11 9v6"></path>
        <path d="M13 9v6"></path>
      </svg>
      <span class="table-toolbar__button-label">Unmerge</span>
    </button>
  </div>

  <div class="table-toolbar__separator"></div>

  <div class="table-toolbar__group">
    <button
      type="button"
      class="table-toolbar__button"
      [class.table-toolbar__button--active]="formattingState.isBold"
      (mousedown)="onBoldClick($event)"
      title="Bold (Ctrl+B)"
    >
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
        <path d="M6 4h8a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"></path>
        <path d="M6 12h9a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"></path>
      </svg>
    </button>

    <button
      type="button"
      class="table-toolbar__button"
      [class.table-toolbar__button--active]="formattingState.isItalic"
      (mousedown)="onItalicClick($event)"
      title="Italic (Ctrl+I)"
    >
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="19" y1="4" x2="10" y2="4"></line>
        <line x1="14" y1="20" x2="5" y2="20"></line>
        <line x1="15" y1="4" x2="9" y2="20"></line>
      </svg>
    </button>
  </div>

  <div class="table-toolbar__separator"></div>

  <div class="table-toolbar__group">
    <button
      type="button"
      class="table-toolbar__button"
      [class.table-toolbar__button--active]="formattingState.textAlign === 'left'"
      (mousedown)="onAlignClick($event, 'left')"
      title="Align Left"
    >
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="17" y1="10" x2="3" y2="10"></line>
        <line x1="21" y1="6" x2="3" y2="6"></line>
        <line x1="21" y1="14" x2="3" y2="14"></line>
        <line x1="17" y1="18" x2="3" y2="18"></line>
      </svg>
    </button>

    <button
      type="button"
      class="table-toolbar__button"
      [class.table-toolbar__button--active]="formattingState.textAlign === 'center'"
      (mousedown)="onAlignClick($event, 'center')"
      title="Align Center"
    >
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="18" y1="10" x2="6" y2="10"></line>
        <line x1="21" y1="6" x2="3" y2="6"></line>
        <line x1="21" y1="14" x2="3" y2="14"></line>
        <line x1="18" y1="18" x2="6" y2="18"></line>
      </svg>
    </button>

    <button
      type="button"
      class="table-toolbar__button"
      [class.table-toolbar__button--active]="formattingState.textAlign === 'right'"
      (mousedown)="onAlignClick($event, 'right')"
      title="Align Right"
    >
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="21" y1="10" x2="7" y2="10"></line>
        <line x1="21" y1="6" x2="3" y2="6"></line>
        <line x1="21" y1="14" x2="3" y2="14"></line>
        <line x1="21" y1="18" x2="7" y2="18"></line>
      </svg>
    </button>
  </div>

  <div class="table-toolbar__separator"></div>

  <div class="table-toolbar__group">
    <button
      type="button"
      class="table-toolbar__button"
      [class.table-toolbar__button--active]="formattingState.verticalAlign === 'top'"
      (mousedown)="onVerticalAlignClick($event, 'top')"
      title="Align Top"
    >
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="12" y1="3" x2="12" y2="15"></line>
        <polyline points="18 9 12 3 6 9"></polyline>
        <line x1="5" y1="21" x2="19" y2="21"></line>
      </svg>
    </button>

    <button
      type="button"
      class="table-toolbar__button"
      [class.table-toolbar__button--active]="formattingState.verticalAlign === 'middle'"
      (mousedown)="onVerticalAlignClick($event, 'middle')"
      title="Align Middle"
    >
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="5" y1="12" x2="19" y2="12"></line>
        <polyline points="9 8 12 5 15 8"></polyline>
        <polyline points="9 16 12 19 15 16"></polyline>
      </svg>
    </button>

    <button
      type="button"
      class="table-toolbar__button"
      [class.table-toolbar__button--active]="formattingState.verticalAlign === 'bottom'"
      (mousedown)="onVerticalAlignClick($event, 'bottom')"
      title="Align Bottom"
    >
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="12" y1="21" x2="12" y2="9"></line>
        <polyline points="18 15 12 21 6 15"></polyline>
        <line x1="5" y1="3" x2="19" y2="3"></line>
      </svg>
    </button>
  </div>

  <div class="table-toolbar__separator"></div>

  <div class="table-toolbar__group">
    <!-- Text Color Picker -->
    <app-color-picker
      [currentColor]="textColor"
      [colorPalette]="textColorPalette"
      icon="format_color_text"
      [disabled]="!hasActiveCell"
      title="Text color"
      (colorSelected)="onTextColorSelected($event)"
    ></app-color-picker>

    <!-- Text Highlight Picker -->
    <app-color-picker
      [currentColor]="highlightColor"
      [colorPalette]="highlightFillPalette"
      icon="format_ink_highlighter"
      [disabled]="!hasActiveCell"
      title="Text highlight"
      (colorSelected)="onHighlightSelected($event)"
    ></app-color-picker>

    <!-- Cell Fill Picker -->
    <app-color-picker
      [currentColor]="cellFillColor"
      [colorPalette]="highlightFillPalette"
      icon="format_color_fill"
      [disabled]="!hasActiveCell"
      title="Cell fill"
      (colorSelected)="onCellFillSelected($event)"
    ></app-color-picker>

    <!-- Border (single dropdown with live preview: color + style + width) -->
    <app-border-picker
      [disabled]="!hasActiveCell"
      title="Border"
      [colorPalette]="highlightFillPalette"
      [value]="{ color: borderColor, width: borderWidth, style: borderStyle }"
      (valueChange)="onBorderValueChange($event)"
    ></app-border-picker>
  </div>

  <div class="table-toolbar__separator"></div>

  <div class="table-toolbar__group">
    <button
      type="button"
      class="table-toolbar__button"
      [class.table-toolbar__button--active]="isFormatPainterActive"
      (mousedown)="onFormatPainterClick($event)"
      title="Format painter (cell formatting)"
    >
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 6h12l2 2v3H3z"></path>
        <path d="M6 11v9"></path>
        <path d="M6 20h8"></path>
        <path d="M16 11v4"></path>
      </svg>
    </button>
  </div>
</div>

<div
  *ngIf="splitDialogOpen"
  class="table-toolbar__modal-backdrop"
  (mousedown)="closeSplitDialog($event)"
>
  <div class="table-toolbar__modal" (mousedown)="$event.stopPropagation()">
    <div class="table-toolbar__modal-title">Split cell</div>

    <div class="table-toolbar__modal-row">
      <label class="table-toolbar__label">
        Rows
        <input
          class="table-toolbar__input"
          type="number"
          min="1"
          [max]="splitMax"
          [(ngModel)]="splitRows"
        />
      </label>

      <label class="table-toolbar__label">
        Columns
        <input
          class="table-toolbar__input"
          type="number"
          min="1"
          [max]="splitMax"
          [(ngModel)]="splitCols"
        />
      </label>
    </div>

    <div class="table-toolbar__modal-actions">
      <button type="button" class="table-toolbar__action" (mousedown)="closeSplitDialog($event)">
        Cancel
      </button>
      <button type="button" class="table-toolbar__action table-toolbar__action--primary" (mousedown)="confirmSplit($event)">
        OK
      </button>
    </div>
  </div>
</div>

