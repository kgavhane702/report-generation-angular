<div class="table-toolbar" *ngIf="hasActiveTable">
  <div class="table-toolbar__group">
    <button
      type="button"
      class="table-toolbar__button"
      [class.table-toolbar__button--active]="textAlign === 'left'"
      (click)="applyTextAlign('left')"
      title="Align Left"
    >
      <span class="material-symbols-outlined">format_align_left</span>
    </button>
    <button
      type="button"
      class="table-toolbar__button"
      [class.table-toolbar__button--active]="textAlign === 'center'"
      (click)="applyTextAlign('center')"
      title="Align Center"
    >
      <span class="material-symbols-outlined">format_align_center</span>
    </button>
    <button
      type="button"
      class="table-toolbar__button"
      [class.table-toolbar__button--active]="textAlign === 'right'"
      (click)="applyTextAlign('right')"
      title="Align Right"
    >
      <span class="material-symbols-outlined">format_align_right</span>
    </button>
  </div>

  <div class="table-toolbar__group">
    <button
      type="button"
      class="table-toolbar__button"
      [class.table-toolbar__button--active]="fontWeight === 'bold'"
      (click)="toggleBold()"
      title="Bold"
    >
      <span class="material-symbols-outlined">format_bold</span>
    </button>
    <button
      type="button"
      class="table-toolbar__button"
      [class.table-toolbar__button--active]="fontStyle === 'italic'"
      (click)="toggleItalic()"
      title="Italic"
    >
      <span class="material-symbols-outlined">format_italic</span>
    </button>
    <button
      type="button"
      class="table-toolbar__button"
      [class.table-toolbar__button--active]="textDecoration === 'underline'"
      (click)="toggleUnderline()"
      title="Underline"
    >
      <span class="material-symbols-outlined">format_underlined</span>
    </button>
  </div>

  <div class="table-toolbar__group">
    <div class="table-toolbar__dropdown-container">
      <button
        type="button"
        class="table-toolbar__button table-toolbar__button--dropdown"
        (click)="showFontSizeDropdown = !showFontSizeDropdown"
        title="Font Size"
      >
        <span>{{ fontSize }}px</span>
        <span class="material-symbols-outlined">arrow_drop_down</span>
      </button>
      <div class="table-toolbar__dropdown" *ngIf="showFontSizeDropdown">
        <button
          *ngFor="let size of fontSizes"
          type="button"
          class="table-toolbar__dropdown-item"
          [class.table-toolbar__dropdown-item--active]="fontSize === size"
          (click)="applyFontSize(size)"
        >
          {{ size }}px
        </button>
      </div>
    </div>
  </div>

  <div class="table-toolbar__group">
    <div class="table-toolbar__color-picker-container">
      <button
        type="button"
        class="table-toolbar__button table-toolbar__color-trigger"
        (click)="showTextColorDropdown = !showTextColorDropdown"
        title="Text Color"
      >
        <div
          class="table-toolbar__color-preview"
          [style.background-color]="getDisplayTextColor()"
        ></div>
        <span class="material-symbols-outlined">arrow_drop_down</span>
      </button>
      <div class="table-toolbar__color-dropdown" *ngIf="showTextColorDropdown">
        <div class="table-toolbar__color-custom">
          <input
            type="color"
            [value]="getDisplayTextColor()"
            (change)="onTextColorInputChange($event)"
            class="table-toolbar__color-input"
            title="Custom Color"
          />
          <span class="table-toolbar__color-value">{{ color || '#000000' }}</span>
        </div>
        <div class="table-toolbar__color-swatches">
          <button
            *ngFor="let color of colorPalette"
            type="button"
            class="table-toolbar__color-swatch"
            [style.background-color]="color.value || '#000000'"
            [class.table-toolbar__color-swatch--active]="(color || '#000000') === color"
            [attr.title]="color.label"
            (click)="applyTextColor(color.value || '#000000')"
          ></button>
        </div>
      </div>
    </div>
  </div>

  <div class="table-toolbar__group">
    <div class="table-toolbar__color-picker-container">
      <button
        type="button"
        class="table-toolbar__button table-toolbar__color-trigger"
        (click)="showBackgroundColorDropdown = !showBackgroundColorDropdown"
        title="Background Color"
      >
        <div
          class="table-toolbar__color-preview"
          [style.background-color]="getDisplayBackgroundColor()"
          [class.table-toolbar__color-preview--transparent]="!backgroundColor"
        >
          <span *ngIf="!backgroundColor" class="table-toolbar__transparent-icon">×</span>
        </div>
        <span class="material-symbols-outlined">arrow_drop_down</span>
      </button>
      <div class="table-toolbar__color-dropdown" *ngIf="showBackgroundColorDropdown">
        <div class="table-toolbar__color-custom">
          <input
            type="color"
            [value]="backgroundColor || '#ffffff'"
            (change)="onBackgroundColorInputChange($event)"
            class="table-toolbar__color-input"
            title="Custom Color"
          />
          <span class="table-toolbar__color-value">{{ backgroundColor || 'transparent' }}</span>
        </div>
        <div class="table-toolbar__color-swatches">
          <button
            *ngFor="let color of colorPalette"
            type="button"
            class="table-toolbar__color-swatch"
            [style.background-color]="color.value || 'transparent'"
            [class.table-toolbar__color-swatch--active]="(backgroundColor || '') === color.value"
            [class.table-toolbar__color-swatch--transparent]="!color.value"
            [attr.title]="color.label"
            (click)="applyBackgroundColor(color.value)"
          >
            <span *ngIf="!color.value" class="table-toolbar__transparent-icon">×</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="table-toolbar__group">
    <button
      type="button"
      class="table-toolbar__button"
      [class.table-toolbar__button--active]="verticalAlign === 'top'"
      (click)="applyVerticalAlign('top')"
      title="Align Top"
    >
      <span class="material-symbols-outlined">vertical_align_top</span>
    </button>
    <button
      type="button"
      class="table-toolbar__button"
      [class.table-toolbar__button--active]="verticalAlign === 'middle'"
      (click)="applyVerticalAlign('middle')"
      title="Align Middle"
    >
      <span class="material-symbols-outlined">vertical_align_center</span>
    </button>
    <button
      type="button"
      class="table-toolbar__button"
      [class.table-toolbar__button--active]="verticalAlign === 'bottom'"
      (click)="applyVerticalAlign('bottom')"
      title="Align Bottom"
    >
      <span class="material-symbols-outlined">vertical_align_bottom</span>
    </button>
  </div>

  <div class="table-toolbar__group">
    <div class="table-toolbar__dropdown-container">
      <button
        type="button"
        class="table-toolbar__button table-toolbar__button--dropdown"
        (click)="showBorderDropdown = !showBorderDropdown"
        title="Border Style"
      >
        <span class="material-symbols-outlined">border_style</span>
        <span class="material-symbols-outlined">arrow_drop_down</span>
      </button>
      <div class="table-toolbar__dropdown table-toolbar__dropdown--borders" *ngIf="showBorderDropdown">
        <div class="table-toolbar__border-section">
          <label class="table-toolbar__border-label">Style</label>
          <button
            type="button"
            class="table-toolbar__border-button"
            [class.table-toolbar__border-button--active]="borderStyle === 'solid'"
            (click)="applyBorderStyle('solid')"
            title="Solid"
          >
            <div class="table-toolbar__border-preview" style="border: 2px solid #000;"></div>
          </button>
          <button
            type="button"
            class="table-toolbar__border-button"
            [class.table-toolbar__border-button--active]="borderStyle === 'dashed'"
            (click)="applyBorderStyle('dashed')"
            title="Dashed"
          >
            <div class="table-toolbar__border-preview" style="border: 2px dashed #000;"></div>
          </button>
          <button
            type="button"
            class="table-toolbar__border-button"
            [class.table-toolbar__border-button--active]="borderStyle === 'dotted'"
            (click)="applyBorderStyle('dotted')"
            title="Dotted"
          >
            <div class="table-toolbar__border-preview" style="border: 2px dotted #000;"></div>
          </button>
          <button
            type="button"
            class="table-toolbar__border-button"
            [class.table-toolbar__border-button--active]="borderStyle === 'none'"
            (click)="applyBorderStyle('none')"
            title="None"
          >
            <div class="table-toolbar__border-preview" style="border: none;"></div>
          </button>
        </div>
        <div class="table-toolbar__border-section">
          <label class="table-toolbar__border-label">Width</label>
          <input
            type="number"
            class="table-toolbar__border-input"
            [value]="borderWidth"
            (change)="applyBorderWidth(+($any($event.target).value))"
            min="0"
            max="10"
            title="Border Width"
          />
          <span class="table-toolbar__border-unit">px</span>
        </div>
        <div class="table-toolbar__border-section">
          <label class="table-toolbar__border-label">Color</label>
          <div class="table-toolbar__border-color-container">
            <input
              type="color"
              [value]="getDisplayBorderColor()"
              (change)="onBorderColorInputChange($event)"
              class="table-toolbar__color-input table-toolbar__color-input--small"
              title="Border Color"
            />
            <span class="table-toolbar__color-value">{{ borderColor || '#000000' }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="table-toolbar__group">
    <button
      type="button"
      class="table-toolbar__button"
      (click)="insertRowAbove()"
      title="Insert Row Above"
    >
      <span class="material-symbols-outlined">add_box</span>
    </button>
    <button
      type="button"
      class="table-toolbar__button"
      (click)="insertRowBelow()"
      title="Insert Row Below"
    >
      <span class="material-symbols-outlined">add</span>
    </button>
    <button
      type="button"
      class="table-toolbar__button"
      (click)="deleteRow()"
      title="Delete Row"
    >
      <span class="material-symbols-outlined">delete</span>
    </button>
  </div>

  <div class="table-toolbar__group">
    <button
      type="button"
      class="table-toolbar__button"
      (click)="insertColumnLeft()"
      title="Insert Column Left"
    >
      <span class="material-symbols-outlined">add_box</span>
    </button>
    <button
      type="button"
      class="table-toolbar__button"
      (click)="insertColumnRight()"
      title="Insert Column Right"
    >
      <span class="material-symbols-outlined">add</span>
    </button>
    <button
      type="button"
      class="table-toolbar__button"
      (click)="deleteColumn()"
      title="Delete Column"
    >
      <span class="material-symbols-outlined">delete</span>
    </button>
  </div>

  <div class="table-toolbar__group">
    <button
      type="button"
      class="table-toolbar__button"
      (click)="mergeCells()"
      title="Merge Cells"
    >
      <span class="material-symbols-outlined">merge</span>
    </button>
    <button
      type="button"
      class="table-toolbar__button"
      (click)="unmergeCells()"
      title="Unmerge Cells"
    >
      <span class="material-symbols-outlined">call_split</span>
    </button>
  </div>

  <div class="table-toolbar__group">
    <button
      type="button"
      class="table-toolbar__button"
      (click)="copyCells()"
      title="Copy (Ctrl+C)"
    >
      <span class="material-symbols-outlined">content_copy</span>
    </button>
    <button
      type="button"
      class="table-toolbar__button"
      (click)="cutCells()"
      title="Cut (Ctrl+X)"
    >
      <span class="material-symbols-outlined">content_cut</span>
    </button>
    <button
      type="button"
      class="table-toolbar__button"
      (click)="pasteCells()"
      title="Paste (Ctrl+V)"
    >
      <span class="material-symbols-outlined">content_paste</span>
    </button>
  </div>
</div>

